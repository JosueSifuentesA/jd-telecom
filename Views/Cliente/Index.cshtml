@{
   Layout = "~/Views/Shared/_LayoutCliente.cshtml"; 
}

@section Scripts{
   <script src="https://sdk.mercadopago.com/js/v2"></script>
   <script>

         const mp = new MercadoPago('TEST-aa3fee75-b76d-47b1-89f5-5c4bdd117727', {
          locale: 'es-AR'
        });
         const bricksBuilder = mp.bricks();
         const renderCardPaymentBrick = async (bricksBuilder) => {
            const settings = {
               initialization: {
               amount: 100, // monto a ser pago
               payer: {
                  email: "test@test.com",
               },
               },
               customization: {
               visual: {
                  style: {
                     theme: 'default', // | 'dark' | 'bootstrap' | 'flat'
                  }
               },
                  paymentMethods: {
                     maxInstallments: 1,
                  }
               },
               callbacks: {
               onReady: () => {
                 console.log("Brick ready!")
               },
               onSubmit: (cardFormData) => {
           
                  console.log(cardFormData);
                  return new Promise((resolve, reject) => {
                     fetch("/process_payment", {
                     method: "POST",
                     headers: {
                        "Content-Type": "application/json",
                     },
                     body: JSON.stringify(cardFormData)
                     })
                     .then((response) => {
                        resolve();
                     })
                     .catch((error) => {
                        reject();
                     })
                  });
               },
               onError: (error) => {
               },
               },
            };
            window.cardPaymentBrickController = await bricksBuilder.create('cardPayment', 'cardPaymentBrick_container', settings);
         };
         renderCardPaymentBrick(bricksBuilder);
         
   </script>
}

@section Styles{
   <style>
      #form-checkout {
         display: flex;
         flex-direction: column;
         max-width: 600px;
      }

      .container {
         height: 18px;
         display: inline-block;
         border: 1px solid rgb(118, 118, 118);
         border-radius: 2px;
         padding: 1px 2px;
      }
   </style>
}


<section>
   <h1>INDEX</h1>
   <a id="pagarBtn">PAGAR</a>

<div id="cardPaymentBrick_container">
</div>

</section>



